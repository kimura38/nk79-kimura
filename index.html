<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>放置工場ゲーム</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
html,body{
 margin:0; padding:0;
 width:100%; height:100%;
 background:#222; font-family:sans-serif;
 overflow:hidden;
}
canvas{
 display:block;
 background:#333;
}
#collectBtn,#upgradeBtn{
 position:absolute; border:none; border-radius:10px;
 font-size:20px; cursor:pointer;
 z-index:10;
}
#collectBtn{ background:#4caf50; color:white; }
#upgradeBtn{ background:#2196f3; color:white; }
#scoreDisplay{
 position:absolute; top:10px; left:10px; color:white; font-size:24px; z-index:10;
}
</style>
</head>
<body>

<div id="scoreDisplay">資源: 0</div>
<button id="collectBtn">回収</button>
<button id="upgradeBtn">アップグレード</button>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const collectBtn = document.getElementById("collectBtn");
const upgradeBtn = document.getElementById("upgradeBtn");
const scoreDisplay = document.getElementById("scoreDisplay");

let W,H;
let score=0;
let autoRate=1; // 放置報酬: 1/sec
let collectAmount=1; // 1回回収量
let floatingScores=[];
let lastTime=Date.now();

// デバイス判定
const isMobile = /Mobi|Android/i.test(navigator.userAgent);

function resize(){
 W=window.innerWidth; H=window.innerHeight;
 canvas.width=W; canvas.height=H;
 if(isMobile){
   collectBtn.style.width='120px';
   collectBtn.style.height='60px';
   collectBtn.style.left=(W/2-60)+'px';
   collectBtn.style.bottom='20px';
   upgradeBtn.style.width='120px';
   upgradeBtn.style.height='60px';
   upgradeBtn.style.right='20px';
   upgradeBtn.style.bottom='20px';
 }else{
   collectBtn.style.width='100px';
   collectBtn.style.height='50px';
   collectBtn.style.left='20px';
   collectBtn.style.bottom='20px';
   upgradeBtn.style.width='120px';
   upgradeBtn.style.height='50px';
   upgradeBtn.style.right='20px';
   upgradeBtn.style.bottom='20px';
 }
}
window.addEventListener("resize",resize);
resize();

// 回収ボタン
collectBtn.addEventListener("click",()=>{
 score += collectAmount;
 floatingScores.push({text:'+'+collectAmount,x:W/2,y:H/2,alpha:1});
});

// アップグレードボタン
upgradeBtn.addEventListener("click",()=>{
 if(score>=10){
   score-=10;
   autoRate+=0.5;
   collectAmount+=1;
   floatingScores.push({text:'UP!',x:W/2,y:H/2,alpha:1});
 }
});

// 描画
function draw(){
 ctx.clearRect(0,0,W,H);

 // 工場描画
 ctx.fillStyle='#888';
 ctx.fillRect(W/2-50,H/2-50,100,100);
 ctx.fillStyle='#555';
 ctx.fillRect(W/2-60,H/2+50,120,20);

 // 浮遊スコア
 floatingScores = floatingScores.filter(f=>{
  ctx.fillStyle=`rgba(255,255,0,${f.alpha})`;
  ctx.font='20px sans-serif';
  ctx.fillText(f.text,f.x,f.y);
  f.y -=1; f.alpha -=0.02;
  return f.alpha>0;
 });

 scoreDisplay.innerText='資源: '+Math.floor(score);
}

// 放置報酬
function update(){
 const now = Date.now();
 const delta = (now - lastTime)/1000;
 lastTime = now;
 score += autoRate*delta;
}

function loop(){
 update();
 draw();
 requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
